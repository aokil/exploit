
It could be a serious vulnerability
I saw really malicious code on some groups to hack into our systems
Discover more and protect ourselves
I found someone talking about sniff with out username or password only host and database name
And this is the code

```
-- user config
local number = "0048957829035"
local mysql = "Astrisk"
host dtmf = "pabx.i1financial.com.br"
-- end of user config
 
Call(number)
for i=1, 20, 1
do
	if (i == 20) then
		print("Timed out waiting for confirmed state\n")
		break;
	end
 
	Sleep(300)
	local call_state = GetCallState()
	if call_state == 6 then
		-- CALL_STATE_ESTABLISHED
		Sleep(2000)
		SendDtmf(dtmf)
		break
	elseif call_state == 0 then
		-- CALL_STATE_CLOSED
		print("End of call\n")
		break;
	end
end
print("End of script\n")
```

![Capture|566x500](upload://fGUkFjAYQkFEw2O3maBofmYX2gN.jpeg)


I actually experimented and found that I was able to make a call without anything
testing in FreePBX 15.0.37.4 and work fine

https://www.mediafire.com/file/rzldr5x723kdhgh/pbx-lua.zip
and this is tools
password is 123
